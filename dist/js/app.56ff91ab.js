(function(){"use strict";var e={5418:function(e,s,t){var o=t(9242),a=t(3396);function n(e,s,t,o,n,r){const l=(0,a.up)("NavBar"),c=(0,a.up)("router-view");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(l),(0,a.Wm)(c)],64)}t(8052);var r=t(7139);const l={class:"navbar navbar-expand-lg bg-body-tertiary","data-bs-theme":"dark"},c={class:"container"},u=(0,a._)("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation"},[(0,a._)("span",{class:"navbar-toggler-icon"})],-1),i={class:"collapse navbar-collapse",id:"navbarText"},p={class:"navbar-nav me-auto mb-2 mb-lg-0"},d={class:"nav-item"},m={class:"nav-item"},_={key:0,class:"navbar-nav"},f={class:"nav-item"},v={class:"nav-item"},w={key:1,class:"navbar-nav"},g={class:"nav-item"},b={class:"nav-item"};function h(e,s,t,o,n,h){const y=(0,a.up)("router-link");return(0,a.wg)(),(0,a.iD)("nav",l,[(0,a._)("div",c,[(0,a.Wm)(y,{class:"navbar-brand",to:{name:"home"}},{default:(0,a.w5)((()=>[(0,a.Uk)("Myspace")])),_:1}),u,(0,a._)("div",i,[(0,a._)("ul",p,[(0,a._)("li",d,[(0,a.Wm)(y,{class:"nav-link",to:{name:"home"}},{default:(0,a.w5)((()=>[(0,a.Uk)("首页")])),_:1})]),(0,a._)("li",m,[(0,a.Wm)(y,{class:"nav-link",to:{name:"userlist"}},{default:(0,a.w5)((()=>[(0,a.Uk)("好友列表")])),_:1})])]),e.$store.state.user.is_login?((0,a.wg)(),(0,a.iD)("ul",w,[(0,a._)("li",g,[(0,a.Wm)(y,{class:"nav-link",to:{name:"userprofile",params:{userId:e.$store.state.user.id}}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,r.zw)(e.$store.state.user.username),1)])),_:1},8,["to"])]),(0,a._)("li",b,[(0,a.Wm)(y,{class:"nav-link",style:{cursor:"pointer"},onClick:o.logout,to:{name:"home"}},{default:(0,a.w5)((()=>[(0,a.Uk)(" 退出")])),_:1},8,["onClick"])])])):((0,a.wg)(),(0,a.iD)("ul",_,[(0,a._)("li",f,[(0,a.Wm)(y,{class:"nav-link",to:{name:"login"}},{default:(0,a.w5)((()=>[(0,a.Uk)("登录")])),_:1})]),(0,a._)("li",v,[(0,a.Wm)(y,{class:"nav-link",to:{name:"register"}},{default:(0,a.w5)((()=>[(0,a.Uk)("注册")])),_:1})])]))])])])}var y=t(65),k={name:"NavBar",setup(){const e=(0,y.oR)(),s=()=>{e.commit("logout")};return{logout:s}}},C=t(89);const x=(0,C.Z)(k,[["render",h]]);var j=x,U={name:"App",components:{NavBar:j}};const B=(0,C.Z)(U,[["render",n]]);var D=B,O=t(2483);function P(e,s,t,o,n,r){const l=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" welcome ")])),_:1})}const T={class:"home"},I={class:"container"},z={class:"card"},H={class:"card-body"};function W(e,s,t,o,n,r){return(0,a.wg)(),(0,a.iD)("div",T,[(0,a._)("div",I,[(0,a._)("div",z,[(0,a._)("div",H,[(0,a.WI)(e.$slots,"default",{},void 0,!0)])])])])}var Z={name:"ContentBase"};const S=(0,C.Z)(Z,[["render",W],["__scopeId","data-v-dbd087a6"]]);var V=S,q={name:"HomeView",components:{ContentBase:V}};const A=(0,C.Z)(q,[["render",P]]);var R=A;const E=e=>((0,a.dD)("data-v-032ea4c4"),e=e(),(0,a.Cn)(),e),F={class:"row justify-content-md-center"},M={class:"col-3"},L={class:"mb-3"},N=E((()=>(0,a._)("label",{for:"username",class:"form-label"},"用户名",-1))),$={class:"mb-3"},G=E((()=>(0,a._)("label",{for:"password",class:"form-label"},"密码",-1))),Y={class:"error_message"},K=E((()=>(0,a._)("button",{type:"submit",class:"btn btn-primary"},"登录",-1)));function J(e,s,t,n,l,c){const u=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",F,[(0,a._)("div",M,[(0,a._)("form",{onSubmit:s[2]||(s[2]=(...e)=>n.login&&n.login(...e))},[(0,a._)("div",L,[N,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"text",class:"form-control",id:"username"},null,512),[[o.nr,n.username]])]),(0,a._)("div",$,[G,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[o.nr,n.password]])]),(0,a._)("div",Y,(0,r.zw)(n.error_message),1),K],32)])])])),_:1})}t(560);var Q=t(4870),X={name:"LoginView",components:{ContentBase:V},setup(){let e=(0,y.oR)(),s=(0,Q.iH)(""),t=(0,Q.iH)(""),o=(0,Q.iH)("");const a=()=>{o.value="",e.dispatch("login",{username:s.value,password:t.value,success(){ks.push({name:"userlist"})},error(){o.value="用户名或密码错误"}})};return{username:s,password:t,error_message:o,login:a}}};const ee=(0,C.Z)(X,[["render",J],["__scopeId","data-v-032ea4c4"]]);var se=ee;function te(e,s,t,o,n,r){const l=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(l,null,{default:(0,a.w5)((()=>[(0,a.Uk)(" 404 ")])),_:1})}var oe={name:"NotFound",components:{ContentBase:V}};const ae=(0,C.Z)(oe,[["render",te]]);var ne=ae;const re=e=>((0,a.dD)("data-v-70d714a6"),e=e(),(0,a.Cn)(),e),le={class:"row justify-content-md-center"},ce={class:"col-3"},ue={class:"mb-3"},ie=re((()=>(0,a._)("label",{for:"username",class:"form-label"},"用户名",-1))),pe={class:"mb-3"},de=re((()=>(0,a._)("label",{for:"password",class:"form-label"},"密码",-1))),me={class:"mb-3"},_e=re((()=>(0,a._)("label",{for:"password_confirm",class:"form-label"},"确认密码",-1))),fe={class:"error_message"},ve=re((()=>(0,a._)("button",{type:"submit",class:"btn btn-primary"},"注册",-1)));function we(e,s,t,n,l,c){const u=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",le,[(0,a._)("div",ce,[(0,a._)("form",{onSubmit:s[3]||(s[3]=(0,o.iM)(((...e)=>n.register&&n.register(...e)),["prevent"]))},[(0,a._)("div",ue,[ie,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[0]||(s[0]=e=>n.username=e),type:"text",class:"form-control",id:"username"},null,512),[[o.nr,n.username]])]),(0,a._)("div",pe,[de,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[1]||(s[1]=e=>n.password=e),type:"password",class:"form-control",id:"password"},null,512),[[o.nr,n.password]])]),(0,a._)("div",me,[_e,(0,a.wy)((0,a._)("input",{"onUpdate:modelValue":s[2]||(s[2]=e=>n.password_confirm=e),type:"password",class:"form-control",id:"password"},null,512),[[o.nr,n.password_confirm]])]),(0,a._)("div",fe,(0,r.zw)(n.error_message),1),ve],32)])])])),_:1})}var ge=t(7387),be=t.n(ge),he={name:"RegisterView",components:{ContentBase:V},setup(){let e=(0,y.oR)(),s=(0,Q.iH)(""),t=(0,Q.iH)(""),o=(0,Q.iH)(""),a=(0,Q.iH)("");const n=()=>{be().ajax({type:"POST",url:"https://app165.acapp.acwing.com.cn/myspace/user/",data:{username:s.value,password:t.value,password_confirm:a.value},success(a){"success"===a.result?e.dispatch("login",{username:s.value,password:t.value,success(){ks.push({name:"userlist"})}}):o.value=a.result}})};return{username:s,password:t,error_message:o,password_confirm:a,register:n}}};const ye=(0,C.Z)(he,[["render",we],["__scopeId","data-v-70d714a6"]]);var ke=ye;const Ce=["onClick"],xe={class:"card-body"},je={class:"row"},Ue={class:"col-1"},Be=["src"],De={class:"col-11"},Oe={class:"username"},Pe={class:"followercount"};function Te(e,s,t,o,n,l){const c=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(c,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.users,(e=>((0,a.wg)(),(0,a.iD)("div",{class:"card",key:e.id,onClick:s=>o.open_user_profile(e.id)},[(0,a._)("div",xe,[(0,a._)("div",je,[(0,a._)("div",Ue,[(0,a._)("img",{class:"img-fluid",src:e.photo},null,8,Be)]),(0,a._)("div",De,[(0,a._)("div",Oe,(0,r.zw)(e.username),1),(0,a._)("div",Pe,(0,r.zw)(e.followerCount),1)])])])],8,Ce)))),128))])),_:1})}var Ie={name:"UserListView",components:{ContentBase:V},setup(){let e=(0,Q.iH)([]);be().ajax({type:"get",url:"https://app165.acapp.acwing.com.cn/myspace/userlist/",success(s){e.value=s}});const s=(0,y.oR)(),t=e=>{s.state.user.is_login?ks.push({name:"userprofile",params:{userId:e}}):ks.push({name:"login"})};return{users:e,open_user_profile:t}}};const ze=(0,C.Z)(Ie,[["render",Te],["__scopeId","data-v-d82331d2"]]);var He=ze;const We={class:"row"},Ze={class:"col-4"},Se={class:"col-8"};function Ve(e,s,t,o,n,r){const l=(0,a.up)("UserProfileInfo"),c=(0,a.up)("UserProfilePosts"),u=(0,a.up)("ContentBase");return(0,a.wg)(),(0,a.j4)(u,null,{default:(0,a.w5)((()=>[(0,a._)("div",We,[(0,a._)("div",Ze,[(0,a.Wm)(l,{onPost_a_post:o.post_a_post,onFollow:o.follow,onUnfollow:o.unfollow,user:o.user},null,8,["onPost_a_post","onFollow","onUnfollow","user"])]),(0,a._)("div",Se,[(0,a.Wm)(c,{user:o.user,posts:o.posts,onDelete_a_posts:o.delete_a_posts},null,8,["user","posts","onDelete_a_posts"])])])])),_:1})}t(1719);const qe=e=>((0,a.dD)("data-v-0eddf543"),e=e(),(0,a.Cn)(),e),Ae={class:"user-card"},Re=qe((()=>(0,a._)("div",{class:"user-card-head"},null,-1))),Ee={class:"user-card-body"},Fe={class:"user-card-body-left"},Me=["src"],Le={class:"user-card-body-right"},Ne={class:"user-card-body-right-text"},$e={class:"user-card-body-right-text-username"},Ge=qe((()=>(0,a._)("span",{style:{"font-size":"12px",color:"orange","font-style":"italic"}},"Lv 999",-1))),Ye={class:"user-card-body-right-text-reputation"},Ke=qe((()=>(0,a._)("span",{class:"user-card-body-right-text-reputation-item"},[(0,a._)("span",null,"58"),(0,a._)("span",null,"关注")],-1))),Je={class:"user-card-body-right-text-reputation-item"},Qe=qe((()=>(0,a._)("span",null,"粉丝",-1))),Xe={class:"user-card-body-right-text-reputation-item"},es=qe((()=>(0,a._)("span",null,"赞",-1))),ss={class:"user-card-body-right-button"},ts={class:"form-floating"},os=qe((()=>(0,a._)("label",{for:"floatingTextarea2"},null,-1)));function as(e,s,t,n,l,c){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("div",Ae,[Re,(0,a._)("div",Ee,[(0,a._)("div",Fe,[(0,a._)("img",{src:t.user.photo,class:"img-fluid"},null,8,Me)]),(0,a._)("div",Le,[(0,a._)("div",Ne,[(0,a._)("div",$e,[(0,a.Uk)((0,r.zw)(t.user.username)+" ",1),Ge]),(0,a._)("div",Ye,[Ke,(0,a._)("span",Je,[(0,a._)("span",null,(0,r.zw)(t.user.followerCount),1),Qe]),(0,a._)("span",Xe,[(0,a._)("span",null,(0,r.zw)(t.user.praise),1),es])])]),(0,a._)("div",ss,[(0,a._)("a",null,[t.user.is_follow?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:s[0]||(s[0]=(...e)=>n.follow&&n.follow(...e))},"+关注")),t.user.is_follow?((0,a.wg)(),(0,a.iD)("button",{key:1,onClick:s[1]||(s[1]=(...e)=>n.unfollow&&n.unfollow(...e))},"取消关注")):(0,a.kq)("",!0),n.is_me?((0,a.wg)(),(0,a.iD)("button",{key:2,onClick:s[2]||(s[2]=(...e)=>n.post_a_post&&n.post_a_post(...e))},"发帖")):(0,a.kq)("",!0)])])])])]),(0,a._)("div",ts,[os,(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":s[3]||(s[3]=e=>n.content=e),class:"form-control",id:"floatingTextarea2",style:{height:"50px"}},null,512),[[o.nr,n.content]])])])}var ns={name:"UserProfileInfo",props:{user:{type:Object,required:!0}},setup(e,s){let t=(0,Q.iH)(""),o=(0,y.oR)(),n=(0,a.Fl)((()=>o.state.user.id===e.user.id));const r=()=>{s.emit("follow")},l=()=>{s.emit("unfollow")},c=()=>{""!=t.value&&(s.emit("post_a_post",t.value),be().ajax({type:"POST",url:"https://app165.acapp.acwing.com.cn/myspace/post/",headers:{Authorization:"Bearer "+o.state.user.access},data:{content:t.value}}),t.value="")};return{follow:r,unfollow:l,content:t,post_a_post:c,is_me:n}}};const rs=(0,C.Z)(ns,[["render",as],["__scopeId","data-v-0eddf543"]]);var ls=rs;const cs={class:"card"},us={class:"card-body"},is={class:"card"},ps={class:"card-body"},ds=["onClick"];function ms(e,s,t,o,n,l){return(0,a.wg)(),(0,a.iD)("div",cs,[(0,a._)("div",us,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.posts.posts,(e=>((0,a.wg)(),(0,a.iD)("div",{key:e.id},[(0,a._)("div",is,[(0,a._)("div",ps,[(0,a.Uk)((0,r.zw)(e.content)+" ",1),o.is_me?((0,a.wg)(),(0,a.iD)("button",{key:0,onClick:s=>o.delete_a_posts(e.id),type:"button",class:"btn btn-danger btn-secondary btn-sm"},"删除",8,ds)):(0,a.kq)("",!0)])])])))),128))])])}var _s={name:"UserProfilePosts",props:{posts:{type:Object,require:!0},user:{type:Object,require:!0}},setup(e,s){const t=(0,y.oR)();let o=(0,a.Fl)((()=>t.state.user.id===e.user.id));const n=e=>{s.emit("delete_a_posts",e),be().ajax({type:"DELETE",url:"https://app165.acapp.acwing.com.cn/myspace/post/",data:{post_id:e},headers:{Authorization:"Bearer "+t.state.user.access}})};return{is_me:o,delete_a_posts:n}}};const fs=(0,C.Z)(_s,[["render",ms],["__scopeId","data-v-38b184d8"]]);var vs=fs,ws={name:"UserProfileView",components:{ContentBase:V,UserProfileInfo:ls,UserProfilePosts:vs},setup(){const e=(0,O.yj)(),s=e.params.userId,t=(0,y.oR)(),o=(0,Q.qj)({id:"",username:"",photo:"",followerCount:"",is_follow:""}),a=(0,Q.qj)({});be().ajax({type:"GET",url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",data:{user_id:s},headers:{Authorization:"Bearer "+t.state.user.access},success(e){o.id=e.id,o.username=e.username,o.photo=e.photo,o.followerCount=e.followerCount,o.is_follow=e.is_follow}}),be().ajax({type:"GET",url:"https://app165.acapp.acwing.com.cn/myspace/post/",data:{user_id:s},headers:{Authorization:"Bearer "+t.state.user.access},success(e){a.posts=e,a.count=e.length}});const n=()=>{o.is_follow||(o.is_follow=!0,o.followerCount++)},r=()=>{o.is_follow&&(o.is_follow=!1,o.followerCount--)},l=e=>{a.count++,a.posts.unshift({id:a.count,userId:1,content:e})},c=e=>{a.posts=a.posts.filter((s=>s.id!=e)),a.count=a.posts.length};return{user:o,follow:n,unfollow:r,posts:a,post_a_post:l,delete_a_posts:c}}};const gs=(0,C.Z)(ws,[["render",Ve]]);var bs=gs;const hs=[{path:"/",name:"home",component:R},{path:"/userlist/",name:"userlist",component:He},{path:"/userprofile/:userId/",name:"userprofile",component:bs},{path:"/login/",name:"login",component:se},{path:"/404/",name:"404",component:ne},{path:"/register/",name:"register",component:ke},{path:"/:catchAll(.*)",redirect:"/404"}],ys=(0,O.p7)({history:(0,O.r5)(),routes:hs});var ks=ys,Cs=t(1598);const xs={state:{id:"",username:"",photo:"",followerCount:0,access:"",refresh:"",is_login:!1},getters:{},mutations:{updataUser(e,s){e.id=s.id,e.username=s.username,e.photo=s.photo,e.followerCount=s.followerCount,e.access=s.access,e.refresh=s.refresh,e.is_login=s.is_login},updataAccess(e,s){e.access=s},logout(e){e.id="",e.username="",e.photo="",e.followerCount=0,e.access="",e.refresh="",e.is_login=!1}},actions:{login(e,s){be().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/",type:"POST",data:{username:s.username,password:s.password},success(t){const{access:o,refresh:a}=t,n=(0,Cs.Z)(o);setInterval((()=>{be().ajax({url:"https://app165.acapp.acwing.com.cn/api/token/refresh/",type:"POST",data:{refresh:a},success(s){e.commit("updataAccess",s.access)}})}),27e4),be().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/getinfo/",type:"GET",data:{user_id:n.user_id},headers:{Authorization:"Bearer "+o},success(t){e.commit("updataUser",{...t,access:o,refresh:a,is_login:!0}),s.success()}})},error(){s.error()}})}},modules:{}};var js=xs,Us=(0,y.MT)({state:{},getters:{},mutations:{},actions:{},modules:{user:js}});(0,o.ri)(D).use(Us).use(ks).mount("#app")}},s={};function t(o){var a=s[o];if(void 0!==a)return a.exports;var n=s[o]={exports:{}};return e[o].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(s,o,a,n){if(!o){var r=1/0;for(i=0;i<e.length;i++){o=e[i][0],a=e[i][1],n=e[i][2];for(var l=!0,c=0;c<o.length;c++)(!1&n||r>=n)&&Object.keys(t.O).every((function(e){return t.O[e](o[c])}))?o.splice(c--,1):(l=!1,n<r&&(r=n));if(l){e.splice(i--,1);var u=a();void 0!==u&&(s=u)}}return s}n=n||0;for(var i=e.length;i>0&&e[i-1][2]>n;i--)e[i]=e[i-1];e[i]=[o,a,n]}}(),function(){t.n=function(e){var s=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(s,{a:s}),s}}(),function(){t.d=function(e,s){for(var o in s)t.o(s,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:s[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};t.O.j=function(s){return 0===e[s]};var s=function(s,o){var a,n,r=o[0],l=o[1],c=o[2],u=0;if(r.some((function(s){return 0!==e[s]}))){for(a in l)t.o(l,a)&&(t.m[a]=l[a]);if(c)var i=c(t)}for(s&&s(o);u<r.length;u++)n=r[u],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(i)},o=self["webpackChunkmyspace"]=self["webpackChunkmyspace"]||[];o.forEach(s.bind(null,0)),o.push=s.bind(null,o.push.bind(o))}();var o=t.O(void 0,[998],(function(){return t(5418)}));o=t.O(o)})();
//# sourceMappingURL=app.56ff91ab.js.map